# 929. Unique Email Addresses

https://leetcode.com/problems/unique-email-addresses/description/

## Comments

### step1

*   初見から accept まで11:00 くらい
*   最初 `+`, `.` の処理も `split` でやろうかと思ったけど、実際に書いてみると単純な for loop の方が読みやすい
    *   変数名とかめちゃ適当だがたとえばこんな感じ？ Python っぽい気はするけどきもちわるい

```python
local_name, _ = local.name.split('+')
filter(lambda x: x != '.', local_name)
```

*   今回は問題文の制約がやさしい (有効なメールアドレスになるようになっている)
    *   面接だとこれにいろんな制約がつくのかなあ。たとえば + で始まるアドレスがありますよ、とか，@ が複数ありますよ、とか？でもさすがにそのあたりだと一個一個処理していくだけなのでわりと簡単だと思う。
*   standardize というネーミングが良かったのかは今も謎。まあ意味的には合ってるかな
*   str を iterate するときの、1 charactor に対して変数名を何にするか毎回迷う。char は C++ の予約後だからなんとなく嫌だし。今回はループ簡単なので単純な `c` にしたけど
    *   `strs` を iterate するとき `str` は Python の予約語なので、とかも同様。`s` 使いがち。

### step2

*   https://github.com/hayashi-ay/leetcode/pull/25/files
    *   https://github.com/python/cpython/blob/bb3e0c240bc60fe08d332ff5955d54197f79751c/Objects/unicodeobject.c#L11768
    *   上の例、`filter` よりは `replace` か。
    *   str が immutable なのは最初からわかっていたけど CPython での最適化の話は知らなかった。

> 背景として、Python の文字列がイミュータブルであることは常識なので、このコードを見たら誰もが不安にかられるので、その不安感を共有できていますか、という質問です。
で、それに対して、「そう思っていたんですが実験した範囲では最適化が効くみたいです。」という返答は、なかなかに困って、というのも、次の疑問がわいてきます。「いつでもその最適化は行われるのか。インタープリターのバージョンに依存しないのか、たとえば、バージョンアップで最適化がなくなることはないのか。もしも、最適化がされることが保証されていないならば、そのように書いておいたとして、どういった場合に最適化されないのか。そのような仕様が仮にあるのだとしたら、そのドキュメントへのリンクをコメントで書いておいて欲しい。また、Python のバージョンが変わったときには、その最適化がされることが保証されていないならば、そのドキュメントをもう一回見て、バージョンによって仕様が変わっていないかどうかを確認するプロセスが必ず走るようにして欲しい。」
で、ここまでの疑問にその場で答えられるならば、面接官は、なるほど、そうなんですね、といって、Python に詳しい人だと思うでしょう。
で、仕様レベルで最適化が保証されているのだとしても、最低限コメントとして、「このような場合には最適化されることが保証される。どこどこ参照。」と書いておかないと、今後そのコードを読んでデバッグする人が、「むむ、もしかして、今回のタイムアウトの原因はここではないかな?」といって余計な実験をすることになるわけです。
つまり、「あ、Python の文字列はイミュータブルなので、こうしたほうがいいですね。」は減点なしの評価で、まあ、思わずやっちゃうことあるよね、くらいの感覚です。
「この場合は最適化されることが仕様レベルで保証されているのでその旨のコメントを書き足しましょうか。」も減点はしにくいけれども、それだったら join で書き直しませんか、という気分ですね。
つまり、気にしているのは、オーダーが正しく動くか、ではなくて、半年後に読んだ別の同僚が不安にならないか、環境の変化に対して頑健か、なのです。

*   `standardize` でなく `canonicalize` の方が普通かな？
    *   `normalize` なんかもある。これが一番馴染みある
*   ユースケースの想定
    *   https://github.com/Yoshiki-Iwasa/Arai60/pull/13#discussion_r1649832719
    *   https://github.com/plushn/SWE-Arai60/pull/14#discussion_r2051724883
        *   > メールアドレスの長さは最大どれくらいなのか。そのうえで2乗であることは問題なのか。メールアドレスはどこから来るのか。ユーザーからの入力であると思われるので、悪意のある入力が入ってくる可能性があるのではないか。
    *   https://github.com/shintaroyoshida20/leetcode/pull/20#discussion_r2079714768
        *   これ、たとえば、データサイエンス目的の研究で、バッチで統計処理をしているならば、むしろ落ちて欲しいんですよね。そういう意味で状況次第です。
    *   今回は制約から有効なメールアドレスであることは保証されていたのでエラー処理は省略したが…。
    *   ユースケースのことはほんやり考えていただ上記のように超具体的ケースまで想定しないなかった。
*   regex、Python での使い方、ソラでわからないな…
    *   https://github.com/irohafternoon/LeetCode/pull/16#discussion_r2038404103

### step3

*   5:10 -> ? (計測漏れ) -> 4:30 くらい
